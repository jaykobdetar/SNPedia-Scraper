<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNPedia Scraper</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container { 
            width: 90%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }
        
        h1 { 
            font-size: 48px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 18px;
        }
        
        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 30px;
        }
        
        .status-running { background: #4CAF50; color: white; }
        .status-stopped { background: #f44336; color: white; }
        .status-paused { background: #ff9800; color: white; }
        
        .stats { 
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-box { 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
        }
        
        .stat-value { 
            font-size: 42px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .stat-label { 
            color: #666;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .progress-container {
            margin-bottom: 40px;
        }
        
        .progress-bar { 
            width: 100%;
            height: 40px;
            background: #e0e0e0;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill { 
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .current-snp {
            text-align: center;
            margin-top: 10px;
            color: #666;
            font-family: monospace;
            font-size: 16px;
        }
        
        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        button { 
            font-size: 18px;
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .btn-start { 
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }
        
        .btn-stop { 
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
            color: white;
        }
        
        .btn-pause {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .log-container {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .log-header {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .log-entry {
            font-family: monospace;
            font-size: 14px;
            color: #666;
            padding: 5px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin-top: 30px;
            border-radius: 5px;
        }
        
        .info-box h3 {
            color: #1976D2;
            margin-bottom: 10px;
        }
        
        .info-box p {
            color: #555;
            line-height: 1.6;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .pulsing {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        function App() {
            const [status, setStatus] = useState({
                running: false,
                paused: false,
                count: 0,
                current: '',
                total: 110000,
                startTime: null,
                logs: []
            });
            
            const logEndRef = useRef(null);
            
            useEffect(() => {
                // In real app, this would poll the backend
                const interval = setInterval(() => {
                    if (status.running && !status.paused) {
                        setStatus(prev => ({
                            ...prev,
                            count: Math.min(prev.count + 1, prev.total),
                            current: `rs${1000000 + prev.count}`,
                            logs: [...prev.logs.slice(-9), {
                                time: new Date().toLocaleTimeString(),
                                message: `Scraped rs${1000000 + prev.count}`
                            }]
                        }));
                    }
                }, 3000); // Simulating 3-second delay
                
                return () => clearInterval(interval);
            }, [status.running, status.paused]);
            
            useEffect(() => {
                logEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [status.logs]);
            
            const handleStart = () => {
                setStatus(prev => ({
                    ...prev,
                    running: true,
                    paused: false,
                    startTime: Date.now(),
                    logs: [...prev.logs, {
                        time: new Date().toLocaleTimeString(),
                        message: 'Started scraping...'
                    }]
                }));
            };
            
            const handleStop = () => {
                setStatus(prev => ({
                    ...prev,
                    running: false,
                    paused: false,
                    logs: [...prev.logs, {
                        time: new Date().toLocaleTimeString(),
                        message: 'Stopped scraping.'
                    }]
                }));
            };
            
            const handlePause = () => {
                setStatus(prev => ({
                    ...prev,
                    paused: !prev.paused,
                    logs: [...prev.logs, {
                        time: new Date().toLocaleTimeString(),
                        message: prev.paused ? 'Resumed scraping...' : 'Paused scraping.'
                    }]
                }));
            };
            
            const progress = (status.count / status.total) * 100;
            const eta = status.running && status.count > 0 && !status.paused
                ? Math.round((status.total - status.count) * 3 / 3600)
                : 0;
            
            const getStatusBadge = () => {
                if (status.running && !status.paused) return 'status-running';
                if (status.running && status.paused) return 'status-paused';
                return 'status-stopped';
            };
            
            const getStatusText = () => {
                if (status.running && !status.paused) return 'Running';
                if (status.running && status.paused) return 'Paused';
                return 'Stopped';
            };
            
            return (
                <div className="container">
                    <h1>🧬 SNPedia Scraper</h1>
                    <p className="subtitle">Scraping 110,000+ genetic variants from SNPedia</p>
                    
                    <div style={{ textAlign: 'center', marginBottom: '30px' }}>
                        <span className={`status-badge ${getStatusBadge()}`}>
                            {getStatusText()}
                        </span>
                    </div>
                    
                    <div className="stats">
                        <div className="stat-box">
                            <div className="stat-value">{status.count.toLocaleString()}</div>
                            <div className="stat-label">SNPs Scraped</div>
                        </div>
                        <div className="stat-box">
                            <div className="stat-value">{progress.toFixed(1)}%</div>
                            <div className="stat-label">Progress</div>
                        </div>
                        <div className="stat-box">
                            <div className="stat-value">{eta}h</div>
                            <div className="stat-label">Time Remaining</div>
                        </div>
                    </div>
                    
                    <div className="progress-container">
                        <div className="progress-bar">
                            <div className="progress-fill" style={{ width: `${progress}%` }}>
                                {progress > 5 && `${progress.toFixed(1)}%`}
                            </div>
                        </div>
                        {status.current && (
                            <div className={`current-snp ${status.running && !status.paused ? 'pulsing' : ''}`}>
                                Currently scraping: {status.current}
                            </div>
                        )}
                    </div>
                    
                    <div className="controls">
                        <button 
                            className="btn-start" 
                            onClick={handleStart}
                            disabled={status.running}
                        >
                            Start
                        </button>
                        <button 
                            className="btn-pause" 
                            onClick={handlePause}
                            disabled={!status.running}
                        >
                            {status.paused ? 'Resume' : 'Pause'}
                        </button>
                        <button 
                            className="btn-stop" 
                            onClick={handleStop}
                            disabled={!status.running}
                        >
                            Stop
                        </button>
                    </div>
                    
                    <div className="log-container">
                        <div className="log-header">Activity Log</div>
                        {status.logs.map((log, index) => (
                            <div key={index} className="log-entry">
                                [{log.time}] {log.message}
                            </div>
                        ))}
                        <div ref={logEndRef} />
                    </div>
                    
                    <div className="info-box">
                        <h3>ℹ️ Information</h3>
                        <p>
                            This scraper respects SNPedia's robots.txt with a 3-second delay between requests.
                            The full scrape will take approximately 90 hours to complete. Progress is automatically
                            saved, so you can pause and resume at any time. The scraped data will be stored in
                            a local SQLite database (snpedia.db).
                        </p>
                    </div>
                </div>
            );
        }
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
